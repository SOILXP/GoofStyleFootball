-- ModuleScript | decompile
-- FullName: Players.Isaac_Thunder2015.PlayerScripts.PlayerModule.ControlModule.Keyboard

-- Decompiler will be improved VERY SOON!
-- Decompiled with Konstant V2.1, a fast Luau decompiler made in Luau by plusgiant5 (https://discord.gg/brNTY8nX8t)
-- Decompiled on 2025-09-10 13:24:01
-- Luau version 6, Types version 3
-- Time taken: 0.004257 seconds

local UserInputService_upvr = game:GetService("UserInputService")
local ContextActionService_upvr = game:GetService("ContextActionService")
local any_getUserFlag_result1_upvr = require(script.Parent.Parent:WaitForChild("CommonUtils"):WaitForChild("FlagUtil")).getUserFlag("UserUpdateInputConnections")
local zero_vector3_upvr = Vector3.new()
local module_upvr = require(script.Parent:WaitForChild("BaseCharacterController"))
local setmetatable_result1_upvr = setmetatable({}, module_upvr)
setmetatable_result1_upvr.__index = setmetatable_result1_upvr
function setmetatable_result1_upvr.new(arg1) -- Line 24
	--[[ Upvalues[3]:
		[1]: module_upvr (readonly)
		[2]: setmetatable_result1_upvr (readonly)
		[3]: any_getUserFlag_result1_upvr (readonly)
	]]
	local setmetatable_result1 = setmetatable(module_upvr.new(), setmetatable_result1_upvr)
	setmetatable_result1.CONTROL_ACTION_PRIORITY = arg1
	if not any_getUserFlag_result1_upvr then
		setmetatable_result1.textFocusReleasedConn = nil
		setmetatable_result1.textFocusGainedConn = nil
		setmetatable_result1.windowFocusReleasedConn = nil
	end
	setmetatable_result1.forwardValue = 0
	setmetatable_result1.backwardValue = 0
	setmetatable_result1.leftValue = 0
	setmetatable_result1.rightValue = 0
	setmetatable_result1.jumpEnabled = true
	return setmetatable_result1
end
function setmetatable_result1_upvr.Enable(arg1, arg2) -- Line 45
	--[[ Upvalues[3]:
		[1]: any_getUserFlag_result1_upvr (readonly)
		[2]: UserInputService_upvr (readonly)
		[3]: zero_vector3_upvr (readonly)
	]]
	-- KONSTANTERROR: [0] 1. Error Block 20 start (CF ANALYSIS FAILED)
	if not any_getUserFlag_result1_upvr and not UserInputService_upvr.KeyboardEnabled then
		return false
	end
	if arg2 == arg1.enabled then
		return true
	end
	arg1.forwardValue = 0
	arg1.backwardValue = 0
	arg1.leftValue = 0
	arg1.rightValue = 0
	arg1.moveVector = zero_vector3_upvr
	arg1.jumpRequested = false
	arg1:UpdateJump()
	if arg2 then
		arg1:BindContextActions()
		arg1:ConnectFocusEventListeners()
		-- KONSTANTWARNING: GOTO [57] #42
	end
	-- KONSTANTERROR: [0] 1. Error Block 20 end (CF ANALYSIS FAILED)
	-- KONSTANTERROR: [43] 32. Error Block 16 start (CF ANALYSIS FAILED)
	if any_getUserFlag_result1_upvr then
		arg1._connections:disconnectAll()
	else
		arg1:UnbindContextActions()
		arg1:DisconnectFocusEventListeners()
	end
	-- KONSTANTERROR: [43] 32. Error Block 16 end (CF ANALYSIS FAILED)
end
function setmetatable_result1_upvr.UpdateMovement(arg1, arg2) -- Line 83
	--[[ Upvalues[1]:
		[1]: zero_vector3_upvr (readonly)
	]]
	if arg2 == Enum.UserInputState.Cancel then
		arg1.moveVector = zero_vector3_upvr
	else
		arg1.moveVector = Vector3.new(arg1.leftValue + arg1.rightValue, 0, arg1.forwardValue + arg1.backwardValue)
	end
end
function setmetatable_result1_upvr.UpdateJump(arg1) -- Line 91
	arg1.isJumping = arg1.jumpRequested
end
function setmetatable_result1_upvr.BindContextActions(arg1) -- Line 95
	--[[ Upvalues[2]:
		[1]: ContextActionService_upvr (readonly)
		[2]: any_getUserFlag_result1_upvr (readonly)
	]]
	ContextActionService_upvr:BindActionAtPriority("moveForwardAction", function(arg1_2, arg2, arg3) -- Line 101
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		local var9
		if arg2 == Enum.UserInputState.Begin then
			var9 = -1
		else
			var9 = 0
		end
		arg1.forwardValue = var9
		arg1:UpdateMovement(arg2)
		return Enum.ContextActionResult.Pass
	end, false, arg1.CONTROL_ACTION_PRIORITY, Enum.PlayerActions.CharacterForward)
	ContextActionService_upvr:BindActionAtPriority("moveBackwardAction", function(arg1_3, arg2, arg3) -- Line 107
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		local var11
		if arg2 == Enum.UserInputState.Begin then
			var11 = 1
		else
			var11 = 0
		end
		arg1.backwardValue = var11
		arg1:UpdateMovement(arg2)
		return Enum.ContextActionResult.Pass
	end, false, arg1.CONTROL_ACTION_PRIORITY, Enum.PlayerActions.CharacterBackward)
	ContextActionService_upvr:BindActionAtPriority("moveLeftAction", function(arg1_4, arg2, arg3) -- Line 113
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		local var13
		if arg2 == Enum.UserInputState.Begin then
			var13 = -1
		else
			var13 = 0
		end
		arg1.leftValue = var13
		arg1:UpdateMovement(arg2)
		return Enum.ContextActionResult.Pass
	end, false, arg1.CONTROL_ACTION_PRIORITY, Enum.PlayerActions.CharacterLeft)
	ContextActionService_upvr:BindActionAtPriority("moveRightAction", function(arg1_5, arg2, arg3) -- Line 119
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		local var15
		if arg2 == Enum.UserInputState.Begin then
			var15 = 1
		else
			var15 = 0
		end
		arg1.rightValue = var15
		arg1:UpdateMovement(arg2)
		return Enum.ContextActionResult.Pass
	end, false, arg1.CONTROL_ACTION_PRIORITY, Enum.PlayerActions.CharacterRight)
	ContextActionService_upvr:BindActionAtPriority("jumpAction", function(arg1_6, arg2, arg3) -- Line 125
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		local jumpEnabled = arg1.jumpEnabled
		if jumpEnabled then
			if arg2 ~= Enum.UserInputState.Begin then
				jumpEnabled = false
			else
				jumpEnabled = true
			end
		end
		arg1.jumpRequested = jumpEnabled
		arg1:UpdateJump()
		return Enum.ContextActionResult.Pass
	end, false, arg1.CONTROL_ACTION_PRIORITY, Enum.PlayerActions.CharacterJump)
	if any_getUserFlag_result1_upvr then
		arg1._connections:connectManual("moveForwardAction", function() -- Line 145
			--[[ Upvalues[1]:
				[1]: ContextActionService_upvr (copied, readonly)
			]]
			ContextActionService_upvr:UnbindAction("moveForwardAction")
		end)
		arg1._connections:connectManual("moveBackwardAction", function() -- Line 146
			--[[ Upvalues[1]:
				[1]: ContextActionService_upvr (copied, readonly)
			]]
			ContextActionService_upvr:UnbindAction("moveBackwardAction")
		end)
		arg1._connections:connectManual("moveLeftAction", function() -- Line 147
			--[[ Upvalues[1]:
				[1]: ContextActionService_upvr (copied, readonly)
			]]
			ContextActionService_upvr:UnbindAction("moveLeftAction")
		end)
		arg1._connections:connectManual("moveRightAction", function() -- Line 148
			--[[ Upvalues[1]:
				[1]: ContextActionService_upvr (copied, readonly)
			]]
			ContextActionService_upvr:UnbindAction("moveRightAction")
		end)
		arg1._connections:connectManual("jumpAction", function() -- Line 149
			--[[ Upvalues[1]:
				[1]: ContextActionService_upvr (copied, readonly)
			]]
			ContextActionService_upvr:UnbindAction("jumpAction")
		end)
	end
end
function setmetatable_result1_upvr.UnbindContextActions(arg1) -- Line 153
	--[[ Upvalues[1]:
		[1]: ContextActionService_upvr (readonly)
	]]
	ContextActionService_upvr:UnbindAction("moveForwardAction")
	ContextActionService_upvr:UnbindAction("moveBackwardAction")
	ContextActionService_upvr:UnbindAction("moveLeftAction")
	ContextActionService_upvr:UnbindAction("moveRightAction")
	ContextActionService_upvr:UnbindAction("jumpAction")
end
function setmetatable_result1_upvr.ConnectFocusEventListeners(arg1) -- Line 161
	--[[ Upvalues[3]:
		[1]: zero_vector3_upvr (readonly)
		[2]: any_getUserFlag_result1_upvr (readonly)
		[3]: UserInputService_upvr (readonly)
	]]
	local function onFocusReleased() -- Line 162
		--[[ Upvalues[2]:
			[1]: arg1 (readonly)
			[2]: zero_vector3_upvr (copied, readonly)
		]]
		arg1.moveVector = zero_vector3_upvr
		arg1.forwardValue = 0
		arg1.backwardValue = 0
		arg1.leftValue = 0
		arg1.rightValue = 0
		arg1.jumpRequested = false
		arg1:UpdateJump()
	end
	local function onTextFocusGained(arg1_7) -- Line 172
		--[[ Upvalues[1]:
			[1]: arg1 (readonly)
		]]
		arg1.jumpRequested = false
		arg1:UpdateJump()
	end
	if any_getUserFlag_result1_upvr then
		arg1._connections:connect("textBoxFocusReleased", UserInputService_upvr.TextBoxFocusReleased, onFocusReleased)
		arg1._connections:connect("textBoxFocused", UserInputService_upvr.TextBoxFocused, onTextFocusGained)
		arg1._connections:connect("windowFocusReleased", UserInputService_upvr.WindowFocused, onFocusReleased)
	else
		arg1.textFocusReleasedConn = UserInputService_upvr.TextBoxFocusReleased:Connect(onFocusReleased)
		arg1.textFocusGainedConn = UserInputService_upvr.TextBoxFocused:Connect(onTextFocusGained)
		arg1.windowFocusReleasedConn = UserInputService_upvr.WindowFocused:Connect(onFocusReleased)
	end
end
function setmetatable_result1_upvr.DisconnectFocusEventListeners(arg1) -- Line 188
	if arg1.textFocusReleasedConn then
		arg1.textFocusReleasedConn:Disconnect()
		arg1.textFocusReleasedConn = nil
	end
	if arg1.textFocusGainedConn then
		arg1.textFocusGainedConn:Disconnect()
		arg1.textFocusGainedConn = nil
	end
	if arg1.windowFocusReleasedConn then
		arg1.windowFocusReleasedConn:Disconnect()
		arg1.windowFocusReleasedConn = nil
	end
end
return setmetatable_result1_upvr